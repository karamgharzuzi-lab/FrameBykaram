<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxe Mirror Booth | Reservation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts: Playfair/Lato (English), Rubik (Hebrew), Cairo (Arabic) -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Lato:wght@300;400;700&family=Rubik:wght@300;400;600;700&family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        /* === BASE THEME VARIABLES (Dark Default) === */
        :root {
            --bg-body: #1a1a1a;
            --text-main: #e7e5e4;
            --text-muted: #a8a29e;
            --border-color: rgba(231, 229, 228, 0.2);
            --nav-bg: rgba(26, 26, 26, 0.9);
            --input-bg: rgba(255, 255, 255, 0.1);
            --card-border: rgba(231, 229, 228, 0.2);
            --card-hover: rgba(231, 229, 228, 0.05);
            --section-bg: #1c1917; /* stone-900 equivalent */
            --mount-preview-bg: #e5e7eb; /* gray-200 */
        }

        /* === LIGHT THEME OVERRIDES === */
        body.light-theme {
            --bg-body: #f8f5e1;
            --text-main: #4a3f35;
            --text-muted: #78716c;
            --border-color: rgba(74, 63, 53, 0.15);
            --nav-bg: #f8f5e1; /* Set to solid body color match */
            --input-bg: rgba(255, 255, 255, 0.5);
            --card-border: rgba(74, 63, 53, 0.15);
            --card-hover: rgba(74, 63, 53, 0.05);
            --section-bg: #f0ede0;
            --mount-preview-bg: #f5f5f4; /* stone-100 */
        }

        /* Apply Variables */
        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: background-color 0.5s ease, color 0.5s ease;
        }

        /* Language Specific Fonts */
        body[lang="en"] { font-family: 'Lato', sans-serif; }
        body[lang="he"] { font-family: 'Rubik', sans-serif; }
        body[lang="ar"] { font-family: 'Cairo', sans-serif; }
        
        /* Headings */
        h1, h2, h3, .serif-font {
            font-family: 'Playfair Display', serif;
        }
        
        /* Exclude elements with '.always-serif' from being forced to bold/inherit font in non-English modes */
        body:not([lang="en"]) h1:not(.always-serif), 
        body:not([lang="en"]) h2:not(.always-serif), 
        body:not([lang="en"]) h3:not(.always-serif), 
        body:not([lang="en"]) .serif-font:not(.always-serif) {
            font-family: inherit; /* Use main font for titles in He/Ar as Playfair is Latin only */
            font-weight: 700;
        }

        /* Force English Serif Font (Playfair) regardless of language setting */
        .always-serif {
            font-family: 'Playfair Display', serif !important;
        }

        .gold-text {
            /* Updated to match the button's rich metallic gradient */
            background: linear-gradient(to right, #8a6236, #bf953f, #fcf6ba, #b38728, #aa771c, #8a6236);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            transition: background-position 0.5s ease;
        }
        
        /* Shimmer effect on hover */
        .gold-text:hover {
            background-position: right center;
        }

        .gold-border {
            border: 1px solid #bf953f;
        }

        .gold-btn {
            /* Luxury Metallic Gradient with Shimmer Potential */
            background: linear-gradient(to right, #8a6236, #bf953f, #fcf6ba, #b38728, #aa771c, #8a6236);
            background-size: 200% auto;
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5); /* Ensures readability on gold */
            border: 1px solid rgba(255,255,255,0.2);
            transition: all 0.5s ease;
        }
        .gold-btn:hover {
            background-position: right center; /* Animates the gradient for a shimmer effect */
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(191, 149, 63, 0.6);
        }

        /* Component Styling using Variables */
        nav {
            background-color: var(--nav-bg) !important;
            border-bottom-color: var(--border-color) !important;
            transition: background-color 0.5s ease, border-color 0.5s ease;
        }

        /* Overriding Tailwind Colors via CSS for Theme Support */
        .text-stone-400 { color: var(--text-muted) !important; }
        .text-stone-500 { color: var(--text-muted) !important; }
        .border-stone-800, .border-stone-900\/10 { border-color: var(--border-color) !important; }
        .bg-stone-900 { background-color: var(--section-bg) !important; }
        .bg-stone-900\/50 { background-color: var(--section-bg) !important; }

        /* Selection styling */
        .option-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid var(--card-border);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .option-card:hover {
            background-color: var(--card-hover);
            border-color: #bf953f;
            box-shadow: 0 0 20px rgba(191, 149, 63, 0.6); /* Golden shine effect */
        }
        .option-card.selected {
            border-color: #bf953f;
            background-color: rgba(191, 149, 63, 0.1);
            box-shadow: 0 0 15px rgba(191, 149, 63, 0.2);
        }
        
        /* Custom Input Styling */
        .lux-input {
            background: var(--input-bg);
            border: 1px solid var(--border-color);
            color: var(--text-main);
            transition: border-color 0.3s;
        }
        .lux-input:focus {
            outline: none;
            border-color: #bf953f;
        }
        select.lux-input option {
            background-color: var(--bg-body);
            color: var(--text-main);
        }
        
        /* Date picker icon adjustment */
        ::-webkit-calendar-picker-indicator {
            filter: invert(1);
            opacity: 0.5;
            cursor: pointer;
            transition: opacity 0.3s;
        }
        body.light-theme ::-webkit-calendar-picker-indicator {
            filter: invert(0); /* Make icon dark in light theme */
        }
        ::-webkit-calendar-picker-indicator:hover { opacity: 1; }

        /* Photo Mount Styling */
        .photo-mount {
            position: relative;
            overflow: hidden;
        }
        .photo-mount img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80%;
            height: 80%;
            object-fit: cover;
            border: 1px solid rgba(0,0,0,0.1);
        }

        /* Upload Placeholder Styling */
        .upload-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: #1a1a1a;
            border: 2px dashed #444;
            color: #888;
            font-size: 0.8rem;
            cursor: pointer;
        }
        .upload-placeholder:hover {
            border-color: #bf953f;
            color: #bf953f;
        }
        
        /* Language Toggle Button */
        .lang-btn {
            padding: 4px 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
            color: var(--text-muted);
            font-size: 0.75rem;
            letter-spacing: 0.05em;
        }
        .lang-btn:hover {
            color: #bf953f;
            background-color: rgba(191, 149, 63, 0.1);
        }
        .lang-btn.active {
            background: linear-gradient(to right, #bf953f, #b38728);
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(191, 149, 63, 0.3);
        }

        /* Navigation Link Styles */
        .nav-link {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .nav-link:hover {
            color: #bf953f;
            text-shadow: 0 0 5px rgba(191, 149, 63, 0.3);
        }
        .nav-link.active {
            color: #bf953f;
            font-weight: bold;
            border-bottom: 2px solid #bf953f;
            text-shadow: 0 0 12px rgba(191, 149, 63, 0.6);
        }

        /* Preview Area Styles */
        .preview-stage {
            background: radial-gradient(circle at center, #2a2a2a 0%, #000000 100%);
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 50px rgba(0,0,0,0.8);
        }
        
        /* Gallery Styles */
        .gallery-img { transition: transform 0.5s ease; }
        .gallery-item:hover .gallery-img { transform: scale(1.05); }

        /* Custom Dropdown Animation Styles */
        .custom-dropdown-menu {
            transform-origin: top;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px) scale(0.95);
            background-color: var(--nav-bg);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }
        
        .custom-dropdown-menu.open {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }

        .dropdown-arrow {
            transition: transform 0.3s ease;
        }
        .dropdown-arrow.rotate {
            transform: rotate(180deg);
        }

        /* Luxury Page Frame */
        .page-frame {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 9999;
            pointer-events: none;
            
            /* Outer Gold Border */
            border: 1px solid #bf953f;
            
            /* Inner Glow for Depth */
            box-shadow: inset 0 0 20px rgba(191, 149, 63, 0.05);
        }

        /* Inner Thin Line for Detail */
        .page-frame::after {
            content: '';
            position: absolute;
            top: 6px;
            left: 6px;
            right: 6px;
            bottom: 6px;
            border: 1px solid rgba(191, 149, 63, 0.2);
        }

        /* Intro Animation Styles */
        @keyframes logoReveal {
            0% { opacity: 0; transform: scale(0.9) translateY(20px); }
            100% { opacity: 1; transform: scale(1) translateY(0); }
        }
        @keyframes lineExpand {
            0% { width: 0; opacity: 0; }
            50% { width: 60%; opacity: 1; margin: 1rem auto; }
            100% { width: 40%; opacity: 0.8; margin: 1rem auto; }
        }
        .animate-logo-reveal {
            animation: logoReveal 1.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
            animation-delay: 0.5s; /* Slight delay before start */
        }
        .animate-line-expand {
            animation: lineExpand 1.5s ease-out forwards;
            animation-delay: 1.2s; /* Start expanding after logo appears */
        }

        /* Custom Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 12px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-body);
        }
        ::-webkit-scrollbar-thumb {
            background-color: #bf953f; /* Gold handle */
            border-radius: 6px;
            border: 3px solid var(--bg-body); /* Creates padding around handle */
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: #d4af37; /* Lighter gold on hover */
        }
        
        /* Lightbox Styles */
        #lightbox {
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }
        #lightbox-img {
            transition: transform 0.6s cubic-bezier(0.22, 1, 0.36, 1);
            transform: scale(0.9);
        }
        #lightbox.open #lightbox-img {
            transform: scale(1);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col" lang="en">

    <!-- Intro Animation Screen (Hidden by default to prevent reappearing on reload) -->
    <div id="intro-screen" class="fixed inset-0 z-[10000] hidden items-center justify-center bg-black transition-opacity duration-1000">
        <div class="text-center w-full px-4">
            <div class="serif-font always-serif text-4xl md:text-7xl gold-text tracking-widest opacity-0 animate-logo-reveal font-bold">
                FrameByKaram
            </div>
            <div class="mt-4 h-0.5 bg-gradient-to-r from-transparent via-[#bf953f] to-transparent w-0 mx-auto animate-line-expand"></div>
        </div>
    </div>

    <!-- Design Frame -->
    <div class="page-frame"></div>
    
    <!-- LIGHTBOX OVERLAY -->
    <div id="lightbox" class="fixed inset-0 z-[10001] bg-black/95 backdrop-blur-md invisible opacity-0 flex items-center justify-center p-4" onclick="closeLightbox()">
        <div class="relative max-w-5xl max-h-full">
            <!-- Close Button -->
            <button onclick="closeLightbox()" class="absolute -top-12 right-0 md:-right-12 text-stone-400 hover:text-[#bf953f] transition-colors duration-300">
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
            
            <!-- The Image -->
            <img id="lightbox-img" src="" class="max-w-full max-h-[85vh] object-contain border border-[#bf953f] shadow-[0_0_50px_rgba(191,149,63,0.2)] rounded-sm" onclick="event.stopPropagation()">
        </div>
    </div>

    <!-- Navbar (Mobile Optimized) -->
    <nav class="w-full py-4 px-4 md:py-6 md:px-12 border-b border-stone-800 fixed top-0 backdrop-blur-sm z-50 bg-[#1a1a1a]/95">
        <!-- Changed to flex-col on mobile to stack items, row on desktop -->
        <div class="flex flex-col-reverse md:flex-row items-center justify-center md:justify-end gap-4 md:gap-8">
            
            <!-- Nav Links (Now Visible on Mobile) -->
            <div class="flex space-x-6 rtl:space-x-reverse text-xs md:text-sm uppercase tracking-widest text-stone-400">
                <span class="nav-link active" onclick="showPage('booking')" data-page="booking" data-i18n="nav_reserve">Reserve</span>
                <span class="nav-link" onclick="showPage('gallery')" data-page="gallery" data-i18n="nav_gallery">Gallery</span>
                <span class="nav-link" onclick="showPage('about')" data-page="about" data-i18n="nav_about">Contact Us</span>
            </div>

            <!-- Language & Theme Switcher -->
            <div class="flex items-center gap-3 text-xs uppercase tracking-widest md:border-l md:border-stone-900/20 md:pl-4 rtl:border-l-0 rtl:border-r rtl:pl-0 rtl:pr-4">
                <button onclick="toggleTheme()" class="text-stone-400 hover:text-[#bf953f] transition-colors" title="Toggle Theme">
                    <i data-lucide="sun" id="theme-icon-sun" class="hidden w-4 h-4"></i>
                    <i data-lucide="moon" id="theme-icon-moon" class="w-4 h-4"></i>
                </button>
                <div class="w-px h-4 bg-stone-800"></div>
                <button onclick="setLanguage('en')" class="lang-btn active" id="lang-en">EN</button>
                <button onclick="setLanguage('he')" class="lang-btn" id="lang-he">HE</button>
                <button onclick="setLanguage('ar')" class="lang-btn" id="lang-ar">AR</button>
            </div>
        </div>
    </nav>

    <!-- Spacer for Fixed Navbar (Increased height for mobile stack) -->
    <div class="h-32 md:h-24"></div>

    <!-- === BOOKING PAGE SECTION === -->
    <div id="booking-page" class="transition-all duration-500 ease-in-out opacity-100 translate-y-0">
        <!-- Hero / Intro -->
        <header class="text-center py-16 px-4">
            <!-- 1. Bigger MIRROR BOOTH -->
            <div class="serif-font always-serif text-3xl md:text-5xl mb-2 gold-text tracking-wider">MIRROR BOOTH</div>
            
            <!-- 2. Smaller Title -->
            <h1 class="text-xl md:text-3xl mb-0 italic always-serif" data-i18n="hero_title">Reflect Your Elegance</h1>
            
            <!-- 4. Golden Divider Line -->
            <div class="w-24 md:w-32 h-px bg-gradient-to-r from-transparent via-[#bf953f] to-transparent mx-auto my-6 opacity-70"></div>
            
            <!-- 3. Smaller Description -->
            <p class="text-stone-400 max-w-xl mx-auto text-sm md:text-base font-light" data-i18n="hero_subtitle">
                Customize your premium photo experience. Select your finishes below to request a reservation.
            </p>
        </header>

        <!-- Booking Form Container -->
        <main class="flex-grow container mx-auto px-4 pb-20 max-w-3xl">
            
            <form id="bookingForm" onsubmit="event.preventDefault(); sendToWhatsApp();">
                
                <!-- Step 1: Contact Details -->
                <section class="mb-8 md:mb-12">
                    <h2 class="text-xl md:text-2xl mb-4 md:mb-6 border-b border-stone-800 pb-2" data-i18n="step1_title">Your Details</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                        <div>
                        <label class="block text-xs uppercase tracking-wider text-stone-400 mb-2" data-i18n="label_name">Full Name</label>
                        <!-- Reduced mobile padding: changed p-3 to py-2 px-3 -->
                        <input required type="text" id="name" placeholder="Your Name" class="lux-input w-full py-2 px-3 md:p-4 rounded-sm text-base" data-i18n-placeholder="placeholder_name">
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-wider text-stone-400 mb-2" data-i18n="label_phone">Phone Number</label>
                        <input required type="tel" id="phone" placeholder="050-0000000" class="lux-input w-full py-2 px-3 md:p-4 rounded-sm text-base">
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-wider text-stone-400 mb-2" data-i18n="label_date">Event Date</label>
                        <!-- REMOVED onclick="this.showPicker()" to prevent SecurityError -->
                        <input required type="date" id="date" class="lux-input w-full py-2 px-3 md:p-4 rounded-sm cursor-pointer text-base">
                    </div>
                    <div>
                        <label class="block text-xs uppercase tracking-wider text-stone-400 mb-2" data-i18n="label_email">Email Address</label>
                        <input required type="email" id="email" placeholder="client@example.com" class="lux-input w-full py-2 px-3 md:p-4 rounded-sm text-base" data-i18n-placeholder="placeholder_email">
                    </div>
                    
                    <!-- NEW Event Location Field -->
                    <div>
                        <label class="block text-xs uppercase tracking-wider text-stone-400 mb-2" data-i18n="label_location">Event Location</label>
                        <input required type="text" id="location" placeholder="City, Venue name..." class="lux-input w-full py-2 px-3 md:p-4 rounded-sm text-base" data-i18n-placeholder="placeholder_location">
                    </div>

                    <!-- ANIMATED Custom Event Type Dropdown -->
                    <div class="relative">
                        <label class="block text-xs uppercase tracking-wider text-stone-400 mb-2" data-i18n="label_event_type">Event Type</label>
                        
                        <!-- Hidden Input to store the actual value for the form logic -->
                        <input type="hidden" id="eventType">

                        <!-- Trigger Button -->
                        <button type="button" onclick="toggleDropdown()" class="lux-input w-full py-2 px-3 md:p-4 rounded-sm flex justify-between items-center text-left cursor-pointer group text-base">
                            <span id="eventTypeLabel" class="text-stone-400" data-i18n="select_event_type">Select Event Type</span>
                            <i data-lucide="chevron-down" id="dropdownArrow" class="dropdown-arrow w-4 h-4 text-stone-500 group-hover:text-[#bf953f] transition-colors"></i>
                        </button>

                        <!-- Dropdown Menu -->
                        <div id="eventTypeDropdown" class="custom-dropdown-menu absolute z-50 left-0 right-0 top-full mt-1 rounded-sm shadow-xl overflow-hidden w-full">
                            <ul class="flex flex-col text-stone-400">
                                <li class="p-3 md:p-4 hover:bg-stone-800/50 hover:text-[#bf953f] cursor-pointer transition-colors border-b border-stone-800/50 last:border-0" onclick="selectEventOption('Wedding', 'event_wedding')" data-i18n="event_wedding">Wedding</li>
                                <li class="p-3 md:p-4 hover:bg-stone-800/50 hover:text-[#bf953f] cursor-pointer transition-colors border-b border-stone-800/50 last:border-0" onclick="selectEventOption('Engagement', 'event_engagement')" data-i18n="event_engagement">Engagement</li>
                                <li class="p-3 md:p-4 hover:bg-stone-800/50 hover:text-[#bf953f] cursor-pointer transition-colors border-b border-stone-800/50 last:border-0" onclick="selectEventOption('Birthday', 'event_birthday')" data-i18n="event_birthday">Birthday</li>
                                <li class="p-3 md:p-4 hover:bg-stone-800/50 hover:text-[#bf953f] cursor-pointer transition-colors border-b border-stone-800/50 last:border-0" onclick="selectEventOption('Corporate', 'event_corporate')" data-i18n="event_corporate">Corporate</li>
                                <li class="p-3 md:p-4 hover:bg-stone-800/50 hover:text-[#bf953f] cursor-pointer transition-colors" onclick="selectEventOption('Other', 'event_other')" data-i18n="event_other">Other</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

                <!-- Gallery Prompt / Teaser -->
                <div class="text-center mb-8 md:mb-12 animate-pulse">
                    <button type="button" onclick="showPage('gallery')" class="group inline-flex items-center gap-2 transform transition-transform hover:scale-105">
                        <span class="text-lg md:text-xl font-bold tracking-wide border-b-2 border-transparent group-hover:border-[#bf953f] gold-text uppercase" data-i18n="check_gallery_teaser">
                            Check the gallery before you Start
                        </span>
                        <i data-lucide="camera" class="w-5 h-5 md:w-6 md:h-6 text-[#bf953f]"></i>
                    </button>
                </div>

                <!-- Step 2: Mirror Frame -->
                <section class="mb-8 md:mb-12">
                    <h2 class="text-xl md:text-2xl mb-4 md:mb-6 border-b border-stone-800 pb-2" data-i18n="step2_title">Mirror Frame</h2>
                    <p class="text-sm text-stone-400 mb-4" data-i18n="step2_desc">Choose the frame finish for the mirror.</p>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <!-- Gold Option -->
                        <div class="option-card rounded-md p-4 md:p-6 text-center relative group" onclick="selectOption('frame', 'Vintage Gold')">
                            <div class="relative w-full max-w-[8rem] md:max-w-[10rem] aspect-square mx-auto mb-3">
                                <img 
                                    src="royal-gold.png" 
                                    id="img-gold-frame"
                                    alt="Vintage Gold Frame" 
                                    class="w-full h-full rounded-lg object-cover border-2 border-yellow-800 shadow-lg"
                                    onerror="this.style.display='none'; this.parentElement.style.backgroundColor='#bf953f';" 
                                >
                            </div>
                            <h3 class="text-base md:text-lg" data-i18n="frame_gold">Vintage Gold</h3>
                            <div id="check-frame-Vintage Gold" class="hidden absolute top-3 right-3 rtl:right-auto rtl:left-3 text-yellow-500"><i data-lucide="check-circle"></i></div>
                        </div>

                        <!-- Silver Option -->
                        <div class="option-card rounded-md p-4 md:p-6 text-center relative group" onclick="selectOption('frame', 'Vintage Silver')">
                            <div class="w-full max-w-[8rem] md:max-w-[10rem] aspect-square mx-auto mb-3 rounded-lg bg-gradient-to-br from-gray-400 to-gray-100 border-2 border-gray-600 shadow-lg"></div>
                            <h3 class="text-base md:text-lg" data-i18n="frame_silver">Vintage Silver</h3>
                            <div id="check-frame-Vintage Silver" class="hidden absolute top-3 right-3 rtl:right-auto rtl:left-3 text-yellow-500"><i data-lucide="check-circle"></i></div>
                        </div>
                    </div>
                    <input type="hidden" id="frameSelection" required>
                </section>

                <!-- Step 3: Velvet Rope -->
                <section class="mb-8 md:mb-12">
                    <h2 class="text-xl md:text-2xl mb-4 md:mb-6 border-b border-stone-800 pb-2" data-i18n="step3_title">Velvet Rope</h2>
                    <p class="text-sm text-stone-400 mb-4" data-i18n="step3_desc">Select the color of the velvet crowd control ropes.</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Red -->
                    <div class="option-card rounded-md p-4 md:p-6 text-center relative group" onclick="selectOption('rope', 'Red')">
                        <div class="relative w-full max-w-[8rem] md:max-w-[10rem] aspect-square mx-auto mb-3 rounded-lg bg-red-950/10 flex items-center justify-center border-2 border-red-950 shadow-lg overflow-hidden">
                            <img 
                                src="red-rope.png" 
                                id="img-red-rope"
                                alt="Red Velvet Rope" 
                                class="w-4/5 h-4/5 object-contain drop-shadow-md"
                                onerror="this.style.display='none'; this.parentElement.style.backgroundColor='#7f1d1d';"
                            >
                        </div>
                        <h3 class="text-base md:text-lg" data-i18n="rope_red">Red Velvet</h3>
                        <div id="check-rope-Red" class="hidden absolute top-3 right-3 rtl:right-auto rtl:left-3 text-yellow-500"><i data-lucide="check-circle"></i></div>
                    </div>

                    <!-- Pink -->
                    <div class="option-card rounded-md p-4 md:p-6 text-center relative group" onclick="selectOption('rope', 'Pink')">
                        <div class="relative w-full max-w-[8rem] md:max-w-[10rem] aspect-square mx-auto mb-3 rounded-lg bg-pink-500/10 flex items-center justify-center border-2 border-pink-400 shadow-lg overflow-hidden">
                             <img 
                                src="pink-rope.png" 
                                id="img-pink-rope"
                                alt="Pink Velvet Rope" 
                                class="w-4/5 h-4/5 object-contain drop-shadow-md"
                                onerror="this.style.display='none'; this.parentElement.style.backgroundColor='#f472b6';"
                            >
                        </div>
                        <h3 class="text-base md:text-lg" data-i18n="rope_pink">Pink Velvet</h3>
                        <div id="check-rope-Pink" class="hidden absolute top-3 right-3 rtl:right-auto rtl:left-3 text-yellow-500"><i data-lucide="check-circle"></i></div>
                    </div>

                    <!-- White -->
                    <div class="option-card rounded-md p-4 md:p-6 text-center relative group" onclick="selectOption('rope', 'White')">
                        <div class="relative w-full max-w-[8rem] md:max-w-[10rem] aspect-square mx-auto mb-3 rounded-lg bg-gray-200/30 flex items-center justify-center border-2 border-gray-300 shadow-lg overflow-hidden">
                             <img 
                                src="white-rope.png" 
                                id="img-white-rope"
                                alt="White Velvet Rope" 
                                class="w-4/5 h-4/5 object-contain drop-shadow-md"
                                onerror="this.style.display='none'; this.parentElement.style.backgroundColor='#e5e7eb';"
                            >
                        </div>
                        <h3 class="text-base md:text-lg" data-i18n="rope_white">White Velvet</h3>
                        <div id="check-rope-White" class="hidden absolute top-3 right-3 rtl:right-auto rtl:left-3 text-yellow-500"><i data-lucide="check-circle"></i></div>
                    </div>
                </div>
                <input type="hidden" id="ropeSelection" required>
            </section>

                <!-- Step 4: Cardboard / Photo Mount -->
                <section class="mb-8 md:mb-12">
                    <h2 class="text-xl md:text-2xl mb-4 md:mb-6 border-b border-stone-800 pb-2" data-i18n="step4_title">Photo Mount</h2>
                    <p class="text-sm text-stone-400 mb-4" data-i18n="step4_desc">The cardboard frame attached to final printed photos.</p>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <!-- White -->
                        <div class="option-card rounded-md p-4 md:p-6 flex items-center justify-between relative" onclick="selectOption('cardboard', 'White')">
                            <div class="w-full max-w-[8rem] md:max-w-[10rem] aspect-square mx-auto mb-3 rounded-lg bg-gradient-to-br from-white via-gray-50 to-gray-200 border-2 border-gray-200 shadow-lg flex items-center justify-center">
                                <!-- Inner subtle border to imply mount -->
                                <div class="w-3/4 h-3/4 border border-gray-200/50"></div>
                            </div>
                            <h3 class="text-base md:text-lg" data-i18n="mount_white">Classic White</h3>
                            <div id="check-cardboard-White" class="hidden text-yellow-500"><i data-lucide="check-circle"></i></div>
                        </div>

                        <!-- Kraft / Cardboard Color -->
                        <div class="option-card rounded-md p-4 md:p-6 flex items-center justify-between relative" onclick="selectOption('cardboard', 'Natural Kraft')">
                            <div class="w-full max-w-[8rem] md:max-w-[10rem] aspect-square mx-auto mb-3 rounded-lg bg-gradient-to-br from-[#e6ceaa] via-[#d2b48c] to-[#ba9e76] border-2 border-[#a38865] shadow-lg flex items-center justify-center">
                                 <!-- Inner subtle border to imply mount -->
                                 <div class="w-3/4 h-3/4 border border-[#a38865]/30"></div>
                            </div>
                            <h3 class="text-base md:text-lg" data-i18n="mount_kraft">Natural Kraft</h3>
                            <div id="check-cardboard-Natural Kraft" class="hidden text-yellow-500"><i data-lucide="check-circle"></i></div>
                        </div>
                    </div>
                    <input type="hidden" id="cardboardSelection" required>
                </section>

                <!-- Summary & Submit -->
                <section class="bg-stone-900 border border-stone-800 p-6 md:p-8 rounded-lg text-center">
                    <h3 class="serif-font text-xl md:text-2xl mb-4 gold-text" style="text-shadow: 0 0 12px rgba(191, 149, 63, 0.6);" data-i18n="summary_title">Ready to Book?</h3>
                    <p class="text-stone-400 mb-6 text-sm" data-i18n="summary_desc">
                        Clicking the button below will open WhatsApp with your order details pre-filled.
                    </p>
                    <button type="submit" class="gold-btn w-full md:w-auto px-8 md:px-12 py-3 md:py-4 text-base md:text-lg font-bold uppercase tracking-widest rounded-sm" data-i18n="btn_submit">
                        Send Request on WhatsApp
                    </button>
                </section>

            </form>
        </main>
    </div>

    <!-- === GALLERY PAGE SECTION (Hidden by default) === -->
    <div id="gallery-page" class="hidden flex-grow container mx-auto px-4 pb-20 max-w-5xl transition-all duration-500 ease-in-out opacity-0 translate-y-10">
        <header class="text-center py-16 px-4">
            <h1 class="text-4xl md:text-5xl mb-4 italic" data-i18n="gallery_heading">Moments of Elegance</h1>
            <p class="text-stone-400 max-w-xl mx-auto text-lg font-light" data-i18n="gallery_subheading">
                Browse through our collection of past events and mirror experiences.
            </p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-16">
            <!-- Gallery Item 1 -->
            <!-- Added onclick event to trigger lightbox -->
            <div class="gallery-item relative overflow-hidden rounded-lg shadow-lg aspect-[3/4] group cursor-pointer" onclick="openLightbox('luxury.jpg')">
                <img src="luxury.jpg" class="gallery-img w-full h-full object-cover" alt="Wedding Event">
                <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <div class="text-center transform translate-y-4 group-hover:translate-y-0 transition-transform duration-500">
                        <i data-lucide="maximize-2" class="w-8 h-8 text-[#bf953f] mx-auto mb-2"></i>
                        <span class="text-white font-serif italic text-xl">Weddings</span>
                    </div>
                </div>
            </div>

            <!-- Gallery Item 2 -->
            <div class="gallery-item relative overflow-hidden rounded-lg shadow-lg aspect-[3/4] group cursor-pointer" onclick="openLightbox('luxury.jpg')">
                <img src="luxury.jpg" class="gallery-img w-full h-full object-cover" alt="Event Photo">
                <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <div class="text-center transform translate-y-4 group-hover:translate-y-0 transition-transform duration-500">
                        <i data-lucide="maximize-2" class="w-8 h-8 text-[#bf953f] mx-auto mb-2"></i>
                        <span class="text-white font-serif italic text-xl">Events</span>
                    </div>
                </div>
            </div>

            <!-- Gallery Item 3 -->
            <div class="gallery-item relative overflow-hidden rounded-lg shadow-lg aspect-[3/4] group cursor-pointer" onclick="openLightbox('luxury.jpg')">
                <img src="luxury.jpg" class="gallery-img w-full h-full object-cover" alt="Party Photo">
                <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <div class="text-center transform translate-y-4 group-hover:translate-y-0 transition-transform duration-500">
                        <i data-lucide="maximize-2" class="w-8 h-8 text-[#bf953f] mx-auto mb-2"></i>
                        <span class="text-white font-serif italic text-xl">Parties</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center">
            <button onclick="showPage('booking')" class="gold-btn px-12 py-4 text-lg font-bold uppercase tracking-widest rounded-sm">
                <span data-i18n="btn_book_experience">Book This Experience</span>
            </button>
        </div>
    </div>

    <!-- === ABOUT US PAGE SECTION (Hidden by default) === -->
    <div id="about-page" class="hidden flex-grow container mx-auto px-4 pb-20 max-w-3xl transition-all duration-500 ease-in-out opacity-0 translate-y-10">
        <header class="text-center py-16 px-4">
            <div class="serif-font always-serif text-3xl md:text-5xl mb-3 gold-text tracking-wider font-bold">FrameByKaram</div>
            <p class="text-stone-400 max-w-xl mx-auto text-lg font-light" data-i18n="about_subtitle">
                Capturing elegance, one reflection at a time.
            </p>
        </header>

        <div class="bg-stone-900 border border-stone-800 p-8 rounded-lg shadow-xl text-center space-y-8">
            
            <!-- Description -->
            <div>
                <h3 class="serif-font text-2xl mb-4 gold-text" data-i18n="about_heading">Our Story</h3>
                <p class="text-stone-400 leading-relaxed text-sm md:text-base" data-i18n="about_text">
                    We specialize in bringing a touch of luxury to your most cherished moments. Our vintage-styled mirror photo booths are more than just cameras; they are interactive experiences designed to reflect the beauty of your event.
                </p>
            </div>

            <div class="w-full h-px bg-stone-800"></div>

            <!-- Contact Info -->
            <div class="flex flex-col items-center gap-6">
                
                <!-- Phone -->
                <div class="flex flex-col items-center gap-2">
                    <span class="text-xs uppercase tracking-widest text-stone-500" data-i18n="label_phone">Contact Us</span>
                    <!-- Updated href to international format to ensure dialer opens correctly -->
                    <!-- Removed target="_top" to prevent page reload -->
                    <a href="tel:+972524040714" class="text-2xl md:text-3xl font-light text-stone-200 hover:text-[#bf953f] transition-colors font-serif tracking-wide">
                        052-404-0714
                    </a>
                </div>

                <!-- Instagram -->
                <div class="flex flex-col items-center gap-3 mt-4">
                    <span class="text-xs uppercase tracking-widest text-stone-500" data-i18n="label_follow">Follow Us</span>
                    <!-- Circular Gold Instagram Button -->
                    <!-- Added 'relative z-20' to ensure it sits above other layers on mobile -->
                    <a href="https://www.instagram.com/framebykaram?igsh=MXJrYXcxdmd6ZmJjZw==" target="_blank" class="group relative z-20 flex items-center justify-center w-16 h-16 rounded-full border-2 border-[#bf953f] hover:bg-[#bf953f]/10 transition-all duration-300">
                        <i data-lucide="instagram" class="w-8 h-8 text-[#bf953f] transition-transform duration-300 group-hover:scale-110"></i>
                        <!-- Glow effect -->
                        <div class="absolute inset-0 rounded-full shadow-[0_0_15px_rgba(191,149,63,0.3)] group-hover:shadow-[0_0_25px_rgba(191,149,63,0.6)] transition-shadow duration-300"></div>
                    </a>
                </div>

            </div>
        </div>
        
        <div class="text-center mt-12">
            <button onclick="showPage('booking')" class="text-stone-500 hover:text-[#bf953f] transition-colors text-sm uppercase tracking-widest">
                <i data-lucide="arrow-left" class="w-4 h-4 inline-block mr-1 align-middle rtl:rotate-180"></i>
                <span data-i18n="back_to_booking">Back to Reservation</span>
            </button>
        </div>
    </div>

    <footer class="text-center py-8 text-xs text-stone-500 border-t border-stone-800" data-i18n="footer">
        &copy; 2025 Mirror Booth Experience. All rights reserved.
    </footer>

    <script>
        /* --- Intro Animation Logic --- */
        (function playIntro() {
            const intro = document.getElementById('intro-screen');
            
            if (intro) {
                // 1. IMMEDIATE REVEAL: Force the intro to be visible
                intro.classList.remove('hidden');
                intro.classList.add('flex');
                
                // 2. Wait 3 seconds for animation to play, then fade out
                setTimeout(() => {
                    intro.style.transition = "opacity 1s ease";
                    intro.style.opacity = "0";
                    intro.style.pointerEvents = "none";
                    
                    // 3. Remove from DOM after fade is complete to free up resources
                    setTimeout(() => {
                        if (intro.parentNode) intro.parentNode.removeChild(intro);
                    }, 1000);
                }, 3000);
            }
        })();

        // Initialize Icons (Wrapped to prevent blocking)
        try {
            lucide.createIcons();
        } catch (e) {
            console.warn("Icon load failed", e);
        }

        /* --- Theme Switcher --- */
        let currentTheme = 'dark';
        
        function toggleTheme() {
            const body = document.body;
            const sunIcon = document.getElementById('theme-icon-sun');
            const moonIcon = document.getElementById('theme-icon-moon');
            
            if (currentTheme === 'dark') {
                body.classList.add('light-theme');
                currentTheme = 'light';
                sunIcon.classList.remove('hidden');
                moonIcon.classList.add('hidden');
            } else {
                body.classList.remove('light-theme');
                currentTheme = 'dark';
                sunIcon.classList.add('hidden');
                moonIcon.classList.remove('hidden');
            }
            
            if(!document.getElementById('preview-section').classList.contains('hidden')) {
                updatePreview();
            }
        }

        /* --- Page Navigation with Animation --- */
        function showPage(pageId) {
            const pages = ['booking', 'gallery', 'about'];
            const pageElements = {
                booking: document.getElementById('booking-page'),
                gallery: document.getElementById('gallery-page'),
                about: document.getElementById('about-page')
            };
            
            // Find currently active page
            let activePageId = Object.keys(pageElements).find(key => !pageElements[key].classList.contains('hidden'));
            
            // If already on the requested page, do nothing
            if (activePageId === pageId) return;

            const pageToHide = pageElements[activePageId];
            const pageToShow = pageElements[pageId];

            // Update Nav State
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if(link.dataset.page === pageId) link.classList.add('active');
            });

            // Animate Out
            pageToHide.classList.remove('opacity-100', 'translate-y-0');
            pageToHide.classList.add('opacity-0', 'translate-y-10');

            setTimeout(() => {
                pageToHide.classList.add('hidden');
                
                // Prepare New Page
                pageToShow.classList.remove('hidden');
                pageToShow.classList.add('opacity-0', 'translate-y-10');
                pageToShow.classList.remove('opacity-100', 'translate-y-0');

                void pageToShow.offsetWidth; // Force Reflow

                // Animate In
                pageToShow.classList.remove('opacity-0', 'translate-y-10');
                pageToShow.classList.add('opacity-100', 'translate-y-0');
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 500);
        }

        /* --- API Configuration --- */
        const apiKey = ""; // API Key provided by environment

        /* --- Localization System --- */
        
        const translations = {
            en: {
                title: "MIRROR BOOTH",
                nav_experience: "Experience",
                nav_gallery: "Gallery",
                nav_reserve: "Reserve",
                nav_about: "Contact Us",
                hero_title: "Reflect Your Elegance",
                hero_subtitle: "Customize your premium photo experience. Select your finishes below to request a reservation.",
                gallery_heading: "Moments of Elegance",
                gallery_subheading: "Browse through our collection of past events and mirror experiences.",
                // About Us Translations
                about_subtitle: "Capturing elegance, one reflection at a time.",
                about_heading: "Our Story",
                about_text: "We specialize in bringing a touch of luxury to your most cherished moments. Our vintage-styled mirror photo booths are more than just cameras; they are interactive experiences designed to reflect the beauty of your event.",
                label_follow: "Follow Us",
                back_to_booking: "Back to Reservation",
                
                step1_title: "Your Details",
                label_name: "Full Name",
                label_phone: "Phone Number",
                label_date: "Event Date",
                label_email: "Email Address",
                label_location: "Event Location",
                placeholder_location: "City, Venue name...",
                step2_title: "Mirror Frame",
                step2_desc: "Choose the frame finish for the mirror.",
                frame_gold: "Vintage Gold",
                frame_silver: "Vintage Silver",
                step3_title: "Velvet Rope",
                step3_desc: "Select the color of the velvet crowd control ropes.",
                rope_red: "Red Velvet",
                rope_pink: "Pink Velvet",
                rope_white: "White Velvet",
                step4_title: "Photo Mount",
                step4_desc: "The cardboard frame attached to final printed photos.",
                mount_white: "Classic White",
                mount_kraft: "Natural Kraft",
                check_gallery_teaser: "Check the gallery before you Start",
                // Event Type Translations
                label_event_type: "Event Type",
                select_event_type: "Select Event Type",
                event_wedding: "Wedding",
                event_engagement: "Engagement",
                event_birthday: "Birthday",
                event_corporate: "Corporate",
                event_other: "Other",
                preview_title: "Final Result Preview",
                preview_booth: "Booth Setup",
                summary_title: "Ready to Book?",
                summary_desc: "Clicking the button below will open WhatsApp with your order details pre-filled.",
                btn_submit: "Send Request on WhatsApp",
                btn_book_experience: "Book This Experience",
                alert_contact: "Please fill in all contact details.",
                alert_select: "Please select an option for Frame, Rope, and Photo Mount.",
                placeholder_name: "Your Name",
                placeholder_email: "client@example.com",
                footer: "© 2025 Mirror Booth Experience. All rights reserved."
            },
            he: {
                title: "מירור בות׳",
                nav_experience: "חוויה",
                nav_gallery: "גלריה",
                nav_reserve: "הזמנה",
                nav_about: "צור קשר",
                hero_title: "Reflect Your Elegance",
                hero_subtitle: "התאם אישית את חווית הצילום שלך. בחר את הגימורים למטה לבקשת הזמנה.",
                gallery_heading: "רגעים של אלגנטיות",
                gallery_subheading: "עיינו באוסף האירועים והחוויות שלנו.",
                // About Us HE
                about_subtitle: "לוכדים אלגנטיות, בכל השתקפות.",
                about_heading: "הסיפור שלנו",
                about_text: "אנו מתמחים בהבאת מגע של יוקרה לרגעים היקרים ביותר שלכם. עמדות הצילום בסגנון וינטג' שלנו הן יותר מסתם מצלמות; הן חוויה אינטראקטיבית המעוצבת לשקף את יופי האירוע שלכם.",
                label_follow: "עקבו אחרינו",
                back_to_booking: "חזרה להזמנה",

                step1_title: "פרטים אישיים",
                label_name: "שם מלא",
                label_phone: "מספר טלפון",
                label_date: "תאריך האירוע",
                label_email: "כתובת אימייל",
                label_location: "מיקום האירוע",
                placeholder_location: "עיר, אולם וכו'",
                step2_title: "מסגרת המראה",
                step2_desc: "בחר את גימור המסגרת למראה.",
                frame_gold: "זהב וינטג׳",
                frame_silver: "כסף וינטג׳",
                step3_title: "חבל קטיפה",
                step3_desc: "בחר את צבע חבלי הקטיפה לתיחום.",
                rope_red: "קטיפה אדומה",
                rope_pink: "קטיפה ורודה",
                rope_white: "קטיפה לבנה",
                step4_title: "מסגרת תמונה",
                step4_desc: "מסגרת הקרטון המצורפת לתמונות המודפסות.",
                mount_white: "לבן קלאסי",
                mount_kraft: "קרפט טבעי",
                check_gallery_teaser: "הציצו בגלריה לפני שמתחילים",
                // Event Type Translations HE
                label_event_type: "סוג אירוע",
                select_event_type: "בחר סוג אירוע",
                event_wedding: "חתונה",
                event_engagement: "אירוסין",
                event_birthday: "יום הולדת",
                event_corporate: "אירוע עסקי",
                event_other: "אחר",
                preview_title: "תצוגה מקדימה",
                preview_booth: "עיצוב העמדה",
                summary_title: "מוכנים להזמין?",
                summary_desc: "לחיצה על הכפתור למטה תפתח את וואטסאפ עם פרטי ההזמנה שלך.",
                btn_submit: "שלח בקשה בוואטסאפ",
                btn_book_experience: "הזמן חוויה זו",
                alert_contact: "נא למלא את כל פרטי הקשר.",
                alert_select: "נא לבחור אפשרות למסגרת, חבל ומסגרת תמונה.",
                placeholder_name: "השם שלך",
                placeholder_email: "client@example.com",
                footer: "© 2025 Mirror Booth Experience. כל הזכויות שמורות."
            },
            ar: {
                title: "مرآة التصوير",
                nav_experience: "تجارب",
                nav_gallery: "معرض",
                nav_reserve: "حجز",
                nav_about: "اتصل بنا",
                hero_title: "Reflect Your Elegance",
                hero_subtitle: "صمم تجربة التصوير الخاصة بك. اختر التشطيبات أدناه لطلب الحجز.",
                gallery_heading: "لحظات من الأناقة",
                gallery_subheading: "تصفح مجموعتنا من الأحداث السابقة وتجارب المرآة.",
                // About Us AR
                about_subtitle: "نلتقط الأناقة، انعكاساً تلو الآخر.",
                about_heading: "قصتنا",
                about_text: "نحن متخصصون في إضفاء لمسة من الفخامة على لحظاتكم الثمينة. أكشاك التصوير ذات الطراز العتيق لدينا هي أكثر من مجرد كاميرات؛ إنها تجارب تفاعلية مصممة لتعكس جمال مناسبتكم.",
                label_follow: "تابعنا",
                back_to_booking: "العودة للحجز",

                step1_title: "التفاصيل الخاصة بك",
                label_name: "الاسم الكامل",
                label_phone: "رقم الهاتف",
                label_date: "تاريخ المناسبة",
                label_email: "البريد الإلكتروني",
                label_location: "موقع المناسبة",
                placeholder_location: "المدينة، القاعة، إلخ",
                step2_title: "إطار المرآة",
                step2_desc: "اختر تشطيب إطار المرآة.",
                frame_gold: "ذهب عتيق",
                frame_silver: "فضة عتيقة",
                step3_title: "حبل المخمل",
                step3_desc: "اختر لون حبال المخمل.",
                rope_red: "مخمل أحمر",
                rope_pink: "مخمل وردي",
                rope_white: "مخمل أبيض",
                step4_title: "إطار الصورة",
                step4_desc: "إطار الكرتون المرفق بالصور المطبوعة.",
                mount_white: "أبيض كلاسيكي",
                mount_kraft: "كرافت طبيعي",
                check_gallery_teaser: "تحقق من المعرض قبل البدء",
                // Event Type Translations AR
                label_event_type: "نوع المناسبة",
                select_event_type: "اختر نوع المناسبة",
                event_wedding: "حفل زفاف",
                event_engagement: "خطوبة",
                event_birthday: "عيد ميلاد",
                event_corporate: "مناسبة للشركات",
                event_other: "آخر",
                preview_title: "معاينة النتيجة النهائية",
                preview_booth: "تجهيز الكشك",
                summary_title: "جاهز للحجز؟",
                summary_desc: "النقر على الزر أدناه سيفتح واتساب مع تفاصيل طلبك.",
                btn_submit: "إرسال الطلب عبر واتساب",
                btn_book_experience: "احجز هذه التجربة",
                alert_contact: "يرجى ملء جميع تفاصيل الاتصال.",
                alert_select: "يرجى اختيار إطار، حبل، وإطار للصورة.",
                placeholder_name: "اسمك",
                placeholder_email: "client@example.com",
                footer: "© 2025 تجربة مرآة التصوير. جميع الحقوق محفوظة."
            }
        };

        let currentLang = 'en';

        function setLanguage(lang) {
            if (currentLang === lang) return;

            // Identify active content area to animate
            const pages = ['booking', 'gallery', 'about'];
            const pageElements = {
                booking: document.getElementById('booking-page'),
                gallery: document.getElementById('gallery-page'),
                about: document.getElementById('about-page')
            };
            
            // Find currently active page
            let activePageId = Object.keys(pageElements).find(key => !pageElements[key].classList.contains('hidden'));
            
            const activePage = pageElements[activePageId];

            // Start Fade Out
            activePage.classList.remove('opacity-100', 'translate-y-0');
            activePage.classList.add('opacity-0', 'translate-y-10');

            setTimeout(() => {
                currentLang = lang;
                const dir = (lang === 'he' || lang === 'ar') ? 'rtl' : 'ltr';
                
                // 1. Set DOM Direction & Lang
                document.documentElement.setAttribute('dir', dir);
                document.documentElement.setAttribute('lang', lang);
                document.body.setAttribute('lang', lang); // For CSS font targeting

                // 2. Update Toggle Buttons
                document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
                document.getElementById(`lang-${lang}`).classList.add('active');

                // 3. Update Text Content
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.getAttribute('data-i18n');
                    if (translations[lang][key]) {
                        el.innerText = translations[lang][key];
                    }
                });

                // 4. Update Placeholders
                document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
                    const key = el.getAttribute('data-i18n-placeholder');
                    if (translations[lang][key]) {
                        el.placeholder = translations[lang][key];
                    }
                });

                // Update preview text if visible
                updatePreview();

                // Fade Back In
                activePage.classList.remove('opacity-0', 'translate-y-10');
                activePage.classList.add('opacity-100', 'translate-y-0');

            }, 500); // 500ms delay to match transition duration
        }

        /* --- Selection & Form Logic --- */

        const selections = {
            frame: null,
            rope: null,
            cardboard: null
        };

        function selectOption(category, value) {
            selections[category] = value;
            document.getElementById(`${category}Selection`).value = value;

            const inputField = document.getElementById(`${category}Selection`);
            const container = inputField.previousElementSibling;
            
            Array.from(container.children).forEach(child => {
                child.classList.remove('selected');
                const checkmark = child.querySelector(`[id^="check-${category}"]`);
                if(checkmark) checkmark.classList.add('hidden');
            });

            const activeCheckmark = document.getElementById(`check-${category}-${value}`);
            if (activeCheckmark) {
                activeCheckmark.classList.remove('hidden');
                activeCheckmark.parentElement.classList.add('selected');
            }

            // Trigger Preview Update
            updatePreview();
        }

        function updatePreview() {
            // Show preview section if any selection is made
            if(selections.frame || selections.rope || selections.cardboard) {
                document.getElementById('preview-section').classList.remove('hidden');
            }

            // 1. Update Frame in Preview
            const previewFrame = document.getElementById('preview-frame');
            previewFrame.innerHTML = ''; // Clear previous
            if(selections.frame === 'Vintage Gold') {
                const img = document.createElement('img');
                img.src = 'royal-gold.png';
                img.className = 'w-full h-full object-contain drop-shadow-2xl';
                // Add error handler just in case file is missing (though redundant with user instructions)
                img.onerror = function() { this.style.display='none'; }; 
                previewFrame.appendChild(img);
            } else if(selections.frame === 'Vintage Silver') {
                const div = document.createElement('div');
                div.className = 'w-full h-full rounded-lg bg-gradient-to-br from-gray-300 via-gray-100 to-gray-400 border-4 border-gray-500 shadow-2xl';
                previewFrame.appendChild(div);
            } else {
                // Placeholder
                previewFrame.innerHTML = '<div class="w-full h-full border-2 border-dashed border-stone-500/50 flex items-center justify-center text-stone-500 text-xs text-center p-2">Select Frame</div>';
            }

            // 2. Update Rope in Preview
            const previewRope = document.getElementById('preview-rope');
            previewRope.innerHTML = '';
            
            if (selections.rope) {
                const img = document.createElement('img');
                
                // Determine source based on selection
                if (selections.rope === 'Red') img.src = 'red-rope.png';
                else if (selections.rope === 'Pink') img.src = 'pink-rope.png';
                else if (selections.rope === 'White') img.src = 'white-rope.png';
                
                // Reduced scale from 125 to 110
                img.className = 'h-full object-contain drop-shadow-lg scale-110 origin-bottom'; 
                img.onerror = function() { this.style.display='none'; };
                previewRope.appendChild(img);
            }

            // 3. Update Mount in Preview
            const previewMount = document.getElementById('preview-mount');
            const previewMountName = document.getElementById('preview-mount-name');
            
            if(selections.cardboard === 'White') {
                // Use a slightly off-white for better contrast in dark mode
                previewMount.className = "w-48 h-60 shadow-lg relative flex items-center justify-center transition-all duration-300 bg-stone-200 border border-stone-300";
                previewMountName.innerText = translations[currentLang].mount_white;
            } else if(selections.cardboard === 'Natural Kraft') {
                previewMount.className = "w-48 h-60 shadow-lg relative flex items-center justify-center transition-all duration-300 bg-[#d2b48c] border border-[#b08d55]";
                previewMountName.innerText = translations[currentLang].mount_kraft;
            }
        }

        /* --- Custom Dropdown Logic --- */
        function toggleDropdown() {
            const dropdown = document.getElementById('eventTypeDropdown');
            const arrow = document.getElementById('dropdownArrow');
            dropdown.classList.toggle('open');
            arrow.classList.toggle('rotate');
        }

        function selectEventOption(value, i18nKey) {
            // 1. Set hidden input value (for form logic)
            document.getElementById('eventType').value = value;
            
            // 2. Update Label Text & Translation Key
            const label = document.getElementById('eventTypeLabel');
            label.setAttribute('data-i18n', i18nKey); // Update key so language switch works
            label.innerText = translations[currentLang][i18nKey]; // Update visual text immediately
            label.classList.remove('text-stone-400'); // Make it look selected/active
            label.classList.add('text-stone-200'); // Brighter color for selected value

            // 3. Close Dropdown
            toggleDropdown();
        }

        // Close dropdown when clicking outside
        window.addEventListener('click', function(e) {
            const dropdown = document.getElementById('eventTypeDropdown');
            const button = document.querySelector('button[onclick="toggleDropdown()"]');
            
            if (dropdown && dropdown.classList.contains('open') && !dropdown.contains(e.target) && !button.contains(e.target)) {
                toggleDropdown();
            }
        });

        /* --- Lightbox Functions --- */
        function openLightbox(imageSrc) {
            const lightbox = document.getElementById('lightbox');
            const img = document.getElementById('lightbox-img');
            
            img.src = imageSrc;
            
            // Reveal
            lightbox.classList.remove('invisible', 'opacity-0');
            lightbox.classList.add('visible', 'opacity-100', 'open');
        }

        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            
            // Hide
            lightbox.classList.remove('visible', 'opacity-100', 'open');
            lightbox.classList.add('invisible', 'opacity-0');
            
            // Clear src after animation to prevent flicker next time
            setTimeout(() => {
                document.getElementById('lightbox-img').src = '';
            }, 500);
        }

        function sendToWhatsApp() {
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            const date = document.getElementById('date').value;
            const email = document.getElementById('email').value;
            const location = document.getElementById('location').value;
            const eventType = document.getElementById('eventType').value;
            const frame = selections.frame;
            const rope = selections.rope;
            const cardboard = selections.cardboard;

            if (!name || !phone || !date || !email || !eventType || !location) {
                alert(translations[currentLang].alert_contact);
                return;
            }
            if (!frame || !rope || !cardboard) {
                alert(translations[currentLang].alert_select);
                return;
            }

            const phoneNumber = "972524040714"; 

            // We keep the actual message in English for the business owner's consistency
            const text = `
*New Mirror Booth Reservation Request* ✨
(Language: ${currentLang.toUpperCase()})

👤 *Name:* ${name}
📱 *Phone:* ${phone}
📅 *Date:* ${date}
📧 *Email:* ${email}
📍 *Location:* ${location}
🎉 *Event Type:* ${eventType}

*Customization Details:*
🪞 *Frame:* ${frame}
🧶 *Rope:* ${rope}
🖼️ *Mount:* ${cardboard}

Please confirm availability. Thank you!
            `.trim();

            const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }
    </script>
</body>
</html>
